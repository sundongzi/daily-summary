##### 性能优化

- [vue官网-性能优化](https://cn.vuejs.org/guide/best-practices/performance.html)
- linux主机页面优化，代码减少`15+`行，渲染速度提高`1s`



```
<template>
  <div class="linuxindex">
    <!-- <h5>Linux主机</h5> -->
    <div class="newtit">
      <el-tabs
        v-model="ActiveName"
      >
        <el-tab-pane
          v-for="item in DataList"
          :ref="item.name"
          :key="item.name"
          :label="item.label"
          :name="item.name"
        >
        </el-tab-pane>
        <!-- 组件缓存 -->
        <keep-alive>
          <component
            :is="ActiveName"
            :ref="ActiveName">
          </component>
        </keep-alive>
      </el-tabs>

      <div class="but">
        <span
          class="time"
          >数据更新时间：
          {{dataUpdateTime}}<i :class="tizts ? 'el-icon-loading' : ''"></i
        ></span>
        <el-button @click="toUpdate">数据更新</el-button>
        <el-button class="export" @click="exportReport">导出</el-button>
      </div>
    </div>
    <el-dialog title="数据更新" class="setUp" :visible.sync="dialogVisible">
      <div style="margin-bottom: 14px">您确定要立即更新数据吗？</div>
      <span slot="footer" class="dialog-footer">
        <el-button @click="dialogVisible = false">取 消</el-button>
        <el-button
          type="primary"
          v-preventReClick
          @click="confirm"
          >确 定</el-button
        >
      </span>
    </el-dialog>
  </div>
</template>
<script>
import assetOverview from "../assetOverview/index.vue";
export default {
  name: "linuxHost",
  computed: {
    // 数据更新时间
    dataUpdateTime () {
      const { updateTime } = this
      let time = updateTime
              ? this.$moment(updateTime).format("YYYY年MM月DD日 HH:mm:ss")
              : "暂无数据"
      return time
    }
  },
  data() {
    return {
      ActiveName: "assetOverview",
      dialogVisible: false,
      updateTime: null,
      // 请求状态
      tizts: false,
      // 定时器
      intervalId: null,
    };
  },
  created() {
    this.DataList = [
        {
          label: "资产概览",
          name: "assetOverview"
        },
        {
          label: "资产分类",
          name: "assetClassification"
        },
      ]
    // if (this.$tools.isEmpty(this.$store.state.linuxHost.info)) {
    //   this.$store.commit('linuxHost/handleTabsChange', 'assetOverview')
    // }
    this.updateT();
  },
  methods: {
    // 抽离获取时间请求的方法
    getTime () {
      return this.$http.getTime({})
    },
    // 数据更新提示
    toUpdate() {
      this.dialogVisible = true;
    },
    updateT() {
      this.getTime().then((res) => {
        const { all } = res
        this.updateTime = Number(all)
      });
    },
    // 数据更新
    confirm() {
      this.dialogVisible = false
      const parameter = {
        assetsType: "ALL",
        createUid: "",
        deadLine: 0,
        description: "全部Linux资产数据采集",
        hostType: "lin",
        taskType: "assets",
      };
      this.$http.updateAll(parameter).then((res) => {
        this.tizts = true;
        if (!res.status) {
          this.$message({
            message: "请求成功",
            type: "success",
          });
          this.dataRefresh();
        }
      });
    },
    // 定时刷新数据函数
    dataRefresh() {
      let nob = 0;
      // 计时器正在进行中，退出函数
      if (this.intervalId !== null) {
        return;
      }
      // 计时器为空，操作
      this.intervalId = setInterval(() => {
        if (nob === 10) {
          this.clear();
          this.tizts = false;
          return;
        }
        this.getTime().then((res) => {
          nob++;
          let { all } = res

          if (this.updateTime !== Number(all)) {
            const _DICT = {
              assetOverview: 'rview',
              assetClassification: 'fication'
            }
            this.$refs[_DICT[this.ActiveName]]?.getDataList();
            this.updateTime = Number(all);
            this.clear();
            this.tizts = false;
          }
        });
      }, 5000);
    },
    // 停止定时器
    clear() {
      clearInterval(this.intervalId); //清除计时器
      this.intervalId = null; //设置为null
    },
    // 导出
    exportReport() {
      this.$util.exportData("getCertificatexport", { type: "lin" }, ["type"]);
    },
  },
  destroyed() {
    // 在页面销毁后，清除计时器
    this.clear();
  },
  components: {
    // 组件按需加载
    assetClassification: () => import('../assetClassification/index.vue'),
    assetOverview,
  },
};
</script>
<style lang="scss" scoped>
::v-deep.linuxindex {
  h5 {
    text-align: left;
    height: 30px;
    line-height: 30px;
    margin: 10px 10px 10px 0;
    font-size: 22px;
    font-family: PingFangSC-Medium, PingFang SC;
    font-weight: 500;
    color: #333;
  }
  .newtit {
    position: relative;
    .el-tabs__header {
      margin-top: -10px;
    }
    .but {
      position: absolute;
      top: 0;
      right: 0;
      font-size: 12px;
      > span.time {
        margin-right: 16px;
      }
      .export {
        height: 32px;
        border-radius: 4px;
        color: #ffffff;
        background-color: #3c91ff;
        border-color: #3c91ff;
      }
      .export:hover {
        background: #146be6;
        border-color: #146be6;
      }
    }
  }
}
</style>

```

